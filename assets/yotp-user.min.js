!function(){var e,t,n,o,r,s,i;function a(t,n){var o=document.querySelector("#"+n+" + .notice");o&&o.parentNode.removeChild(o),e(n).insertAdjacentHTML("afterend",'<div class="notice notice-error inline"><p>'+t+"</p></div>")}function d(t,n){var o=document.querySelector("#"+n+" + .notice");o&&o.parentNode.removeChild(o),e(n).insertAdjacentHTML("afterend",'<div class="notice notice-success inline"><p>'+t+"</p></div>")}function c(){var e=document.querySelector("#new-key + .notice");e&&e.parentNode.removeChild(e),(e=document.querySelector("#registered-keys + .notice"))&&e.parentNode.removeChild(e)}function l(e){e?(n.classList.add("is-active"),o.setAttribute("disabled","")):(n.classList.remove("is-active"),o.removeAttribute("disabled"))}function p(){var t;(l(!1),null===this.response||this.status>=500)?a(yotpSettings.serverError,"new-key"):this.response.ok?((t=r.querySelector("tr.no-items"))&&t.parentNode.removeChild(t),r.insertAdjacentHTML("beforeend",this.response.row),d(this.response.message,"new-key"),s.value="",i.value="",e("_wpnonce").value=this.response.nonce):a(this.response.message,"new-key")}function u(){this.tgt.querySelector(".spinner").classList.remove("is-active"),null!==this.response&&200===this.status?this.response.ok?(d(this.response.message,"registered-keys"),function(e){for(;null!==e&&"TR"!==e.tagName.toUpperCase();)e=e.parentNode;e&&e.parentNode.removeChild(e)}(this.tgt),function(){if(!r.getElementsByTagName("tr").length){var e=document.getElementById("tpl-empty").textContent;r.insertAdjacentHTML("beforeend",e)}}()):a(this.response.message,"registered-keys"):a(wwU2F.serverError,"registered-keys")}function m(){e=document.getElementById.bind(document),t=e("new-key-form"),n=t.querySelector(".spinner"),o=e("submit-button"),r=e("the-list"),s=e("key-name"),i=e("otp"),document.querySelector("table.yotp th.column-actions").style.width=0,t.addEventListener("submit",function(n){if(n.preventDefault(),t.reportValidity()){var o=s.value,r=i.value,a=e("_wpnonce").value,d=new XMLHttpRequest;c(),l(!0),d.open("POST",ajaxurl),d.addEventListener("load",p),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.responseType="json",d.send("action=wwyotp_register&n="+encodeURIComponent(o)+"&o="+encodeURIComponent(r)+"&_wpnonce="+encodeURIComponent(a))}}),document.querySelector("table.yotp > tbody").addEventListener("click",function(e){for(var t=e.target;null!==t&&(!t.tagName||"BUTTON"!==t.tagName.toUpperCase()||-1===t.className.indexOf("revoke-button"));)t=t.parentNode;if(t&&confirm(yotpSettings.revconfirm)){var n=t.dataset.key,o=t.dataset.nonce,r=new XMLHttpRequest;r.tgt=t,r.addEventListener("load",u),r.open("POST",ajaxurl),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.responseType="json";var s=t.querySelector(".spinner");s.style.float="none",s.style.margin=0,s.classList.add("is-active"),c(),r.send("action=wwyotp_revoke&key="+encodeURIComponent(n)+"&_wpnonce="+encodeURIComponent(o))}})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",m):m()}();